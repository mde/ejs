if(typeof fleegix=="undefined"){var fleegix={}}if(typeof $=="undefined"){var $=function(A){return document.getElementById(A)}}var $elem=function(A,E){var C=E||{};var B=document.createElement(A);for(var D in C){B[D]=C[D]}return B};var $text=function(A){return document.createTextNode(A)};fleegix.bind=function(B,A){return function(){B.apply(A,arguments)}};fleegix.extend=function(A,B){return function(){A.apply(this,arguments);A.prototype.constructor.apply(this,arguments);B.apply(this,arguments);this.superClass=A;this.subClass=B}};fleegix.mixin=function(F,C,D){var B;if(typeof C=="function"){B=new C()}else{B=C}var A={};for(var E in B){if(typeof A[E]=="undefined"||baseObjj[E]!=B[E]){if(D&&typeof B[E]=="object"&&B[E]!==null&&!B[E] instanceof Array){fleegix.mixin(F[E],B[E],D)}else{F[E]=B[E]}}}return F};fleegix.clone=function(C){if(typeof C=="object"){var A;if(typeof C.constructor=="function"){A=new C.constructor()}else{A={}}for(var B in C){if(typeof C[B]=="object"&&C[B]!==null){A[B]=fleegix.clone(C[B])}else{A[B]=C[B]}}}else{A=C}return A};if(typeof navigator!="undefined"){fleegix.ua=new function(){var C=navigator.userAgent;var A=function(F,G){var E=G.exec(F);if(E&&E.length>1){E=E[1].substr(0,1);if(!isNaN(E)){return parseInt(E)}else{return null}}return null};this.isWebKit=C.indexOf("AppleWebKit")>-1;this.isKHTML=C.indexOf("KHTML")>-1;this.isGecko=C.indexOf("Gecko")>-1&&!this.isWebKit&&!this.isKHTML;this.isOpera=C.indexOf("Opera")>-1;this.isChrome=C.indexOf("Chrome")>-1;this.isSafari=C.indexOf("Safari")>-1&&!this.isChrome;this.isFF=C.indexOf("Firefox")>-1||C.indexOf("Iceweasel")>-1||C.indexOf("IceCat")>-1;this.isFirefox=this.isFF;this.isIE=C.indexOf("MSIE ")>-1&&!this.isOpera;this.isIPhone=C.indexOf("iPhone")>-1;this.isMobile=this.isIPhone||C.indexOf("Opera Mini")>-1;this.isMac=C.indexOf("Mac")>-1;this.isUnix=C.indexOf("Linux")>-1||C.indexOf("BSD")>-1||C.indexOf("SunOS")>-1;this.isLinux=C.indexOf("Linux")>-1;this.isWindows=C.indexOf("Windows")>-1||C.indexOf("Win");this.majorVersion=null;var B={FF:/Firefox\/([0-9\.]*)/,Safari:/Version\/([0-9\.]*) /,IE:/MSIE ([0-9\.]*);/,Opera:/Opera\/([0-9\.]*) /,Chrome:/Chrome\/([0-9\.]*)/};for(var D in B){if(this["is"+D]){this.majorVersion=A(C,B[D])}}for(var D in this){fleegix[D]=this[D]}}}fleegix.cookie=new function(){this.set=function(B,H,E){var A=E||{};var K="/";var I=0;var G=0;var F=0;var D="";var J=0;if(typeof E=="object"){K=A.path||"/";I=A.days||0;G=A.hours||0;F=A.minutes||0}else{K=E||"/"}J+=I?I*24*60*60*1000:0;J+=G?G*60*60*1000:0;J+=F?F*60*1000:0;if(J){var C=new Date();C.setTime(C.getTime()+J);D="; expires="+C.toGMTString()}else{D=""}document.cookie=B+"="+H+D+"; path="+K};this.get=function(B){var D=B+"=";var A=document.cookie.split(";");for(var C=0;C<A.length;C++){var E=A[C];while(E.charAt(0)==" "){E=E.substring(1,E.length)}if(E.indexOf(D)===0){return E.substring(D.length,E.length)}}return null};this.create=this.set;this.destroy=function(A,C){var B={};B.minutes=-1;if(C){B.path=C}this.set(A,"",B)}};fleegix.form={};fleegix.form.serialize=function(C,B){var A=fleegix.form.toObject(C,B);if(typeof fleegix.url=="undefined"){throw new Error("fleegix.form.serialize depends on the fleegix.url module.")}var D=fleegix.url.objectToQS(A,B);return D};fleegix.form.toObject=function(K,D){var A=D||{};var J={};function H(R,Q){if(R){var P=null;if(typeof R=="string"){P=[];P.push(R)}else{P=R}P.push(Q);return P}else{return Q}}for(var I=0;I<K.elements.length;I++){var F=K.elements[I];if(F.name){var O=F.name.indexOf("[");var C=F.name.indexOf("]");var N="";var B="";var M;var E;if(A.hierarchical&&(O>0)&&(C>2)){N=F.name.substring(0,O);B=F.name.substring(O+1,C);if(typeof J[N]=="undefined"){J[N]={}}M=J[N];E=B}else{M=J;E=F.name}switch(F.type){case"text":case"hidden":case"password":case"textarea":case"select-one":M[E]=F.value;break;case"select-multiple":for(var G=0;G<F.options.length;G++){var L=F.options[G];if(L.selected){M[E]=H(M[E],L.value)}}break;case"radio":if(F.checked){M[E]=F.value}break;case"checkbox":if(F.checked){M[E]=H(M[E],F.value)}break;case"submit":case"reset":case"file":case"image":case"button":if(A.pedantic){M[E]=F.value}break}}}return J};fleegix.form.toHash=fleegix.form.toObject;fleegix.json=new function(){var _cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;var _escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;var _meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\"":"\\\"","\\":"\\\\"};var _quote=function(str){_escapable.lastIndex=0;return _escapable.test(str)?"\""+str.replace(_escapable,function(a){var c=_meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+"\"":"\""+str+"\""};this.serialize=function(obj){var str="";switch(typeof obj){case"object":switch(true){case obj===null:return"null";break;case obj instanceof Array:for(var i=0;i<obj.length;i++){if(str){str+=","}str+=fleegix.json.serialize(obj[i])}return"["+str+"]";break;case (fleegix.isFF&&obj instanceof DOMException):str+="\""+obj.toString()+"\"";break;case typeof obj.toString!="undefined":for(var i in obj){if(str){str+=","}str+="\""+i+"\":";if(typeof obj[i]=="undefined"){str+="\"undefined\""}else{str+=fleegix.json.serialize(obj[i])}}return"{"+str+"}";break}return str;case"unknown":case"undefined":case"function":return"\"undefined\"";case"string":str+=_quote(obj);return str;default:return String(obj)}};this.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}_cx.lastIndex=0;if(_cx.test(text)){text=text.replace(_cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON not parseable.")}};fleegix.string=new function(){var D=/^\s+/;var A=/\s+$/;var C=/^\s+|\s+$/g;var B={"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"};var F=function(G){return function(J){s=J;var H,K;for(var I in B){H=G=="to"?I:B[I];K=G=="to"?B[I]:I;s=s.replace(new RegExp(H,"gm"),K)}return s}};var E=function(G){return function(I){var H="";for(var J in B){H+=G=="to"?J:B[J];H+="|"}H=H.substr(0,H.length-1);H=new RegExp(H,"gm");return H.test(I)}};this.escapeXML=F("to");this.unescapeXML=F("from");this.needsEscape=E("to");this.needsUnescape=E("from");this.toArray=function(I){var G=[];for(var H=0;H<I.length;H++){G[H]=I.substr(H,1)}return G};this.reverse=function(G){return this.toArray(G).reverse().join("")};this.ltrim=function(I,H){var G=H?new RegExp("^"+H+"+"):D;return I.replace(G,"")};this.rtrim=function(I,H){var G=H?new RegExp(H+"+$"):A;return I.replace(G,"")};this.trim=function(I,H){var G=H?new RegExp("^"+H+"+|"+H+"+$","g"):C;return I.replace(G,"")};this.lpad=function(J,I,H){var G=J;while(G.length<H){G=I+G}return G};this.rpad=function(J,I,H){var G=J;while(G.length<H){G=G+I}return G};this.toLowerCaseWithUnderscores=function(G){return G.replace(/([A-Z]+)/g,"_$1").toLowerCase().replace(/^_/,"")};this.deCamelize=function(G){return this.toLowerCaseWithUnderscores(G)};this.toCamelCase=function(G){return G.replace(/_[a-z]{1}/g,function(H){return H.replace("_","").toUpperCase()})};this.camelize=function(G){return this.toCamelCase(G)};this.capitalize=function(G){return G.substr(0,1).toUpperCase()+G.substr(1)}};fleegix.url=new function(){var E=this;var D="\\?|;";var C=new RegExp(D);var B=new RegExp("("+D+")");var A=function(L,M,F,I){var K=B.exec(M);var H;var G;var N;var J;var O="";if(K&&K.length>0){H=K[0]}if(H){G=E.getBase(M);N=E.getQS(M)}else{N=M}J=E.qsToObject(N,{arrayizeMulti:true});if(L=="set"){J[F]=I}else{delete J[F]}if(G){O=G+H}O+=E.objectToQS(J);return O};this.qsToObject=function(N,H){var F=H||{};var M={};var O=F.arrayizeMulti||false;if(N){var L=N.split("&");for(var K=0;K<L.length;K++){var J=L[K].split("=");var G=J[0];var I=decodeURIComponent(J[1]);if(typeof M[G]!="undefined"&&O){if(typeof M[G]=="string"){M[G]=[M[G]]}M[G].push(I)}else{M[G]=I}}}return M};this.objectToQS=function(K,G){var F=G||{};var N="";var M=F.stripTags?/<[^>]*>/g:null;for(var H in K){var R="";var P=K[H];if(P!=undefined){if(P.length&&typeof P!="string"){var Q="";if(F.collapseMulti){Q=",";N+=H+"="}else{Q="&"}for(var I=0;I<P.length;I++){R=F.stripTags?P[I].replace(M,""):P[I];R=(!F.collapseMulti)?H+"="+encodeURIComponent(R):encodeURIComponent(R);N+=R+Q}N=N.substr(0,N.length-1)}else{R=F.stripTags?P.replace(M,""):P;N+=H+"="+encodeURIComponent(R)}N+="&"}else{if(F.includeEmpty){N+=H+"=&"}}}if(F.deCamelizeParams){if(!fleegix.string){throw new Error("deCamelize option depends on fleegix.string module.")}var L=N.split("&");var O;N="";for(var J=0;J<L.length;J++){O=L[J].split("=");if(O[0]){N+=fleegix.string.deCamelize(O[0])+"="+O[1]+"&"}}}N=N.substr(0,N.length-1);return N};this.objectToQs=this.objectToQS;this.getQSParam=function(L,F,K){var J=null;var I=C.test(L)?E.getQS(L):L;var H=K||{};if(I){var G=E.qsToObject(I,H);J=G[F]}return J};this.getQsParam=this.getQSParam;this.setQSParam=function(H,F,G){return A("set",H,F,G)};this.setQsParam=this.setQSParam;this.removeQSParam=function(G,F){return A("remove",G,F,null)};this.removeQsParam=this.removeQSParam;this.getQS=function(F){return F.split(C)[1]};this.getQs=this.getQS;this.getBase=function(F){return F.split(C)[0]};this.getFileExtension=function(H){var F=null;var G=H.split(".");if(G.length>1){F=G[G.length-1]}return F}};fleegix.uri=new function(){this.getParamHash=fleegix.url.qsToObject;this.getParam=function(A,C){var B=C||fleegix.url.getQS(document.location.href);return fleegix.url.getQSParam(B,A)};this.setParam=function(A,D,C){var B=C||fleegix.url.getQS(document.location.href);return fleegix.url.setQSParam(B,A,D)};this.getQuery=fleegix.url.getQS;this.getBase=fleegix.url.getBase};fleegix.html=new function(){var A=function(C){return document.createElement(C)};var B=function(C){return document.createTextNode(C)};this.createSelect=function(G){var E=document.createElement("select");var C=[];var D=null;D=arguments[1];C=G.options;for(var F in G){if(F!="options"){E[F]=G[F]}}if(C){this.setSelectOptions(E,C)}return E};this.setSelectOptions=function(D,C){while(D.firstChild){D.removeChild(D.firstChild)}for(var F=0;F<C.length;F++){var E=A("option");E.value=C[F].value||"";E.appendChild(B(C[F].text));D.appendChild(E);if(C[F].selected){D.selectedIndex=F}}};this.setSelect=function(F,G){var C=0;var E=F.options;for(var D=0;D<E.length;D++){if(E[D].value==G){C=D;break}}F.selectedIndex=C};this.createInput=function(G){var C=null;var F="";if((document.all||navigator.userAgent.indexOf("Safari/41")>-1)&&(G.type=="radio"||G.type=="checkbox")){F="<input type=\""+G.type+"\" name=\""+G.name+"\" id =\""+G.id+"\"";if(G.value){F+=" value=\""+G.value+"\""}if(G.size){F+=" size=\""+G.size+"\""}if(G.maxlength){F+=" maxlength=\""+G.maxlength+"\""}if(G.checked){F+=" checked=\"checked\""}if(G.className){F+=" class=\""+G.className+"\""}F+="/>";var D=A("span");D.innerHTML=F;C=D.firstChild;D.removeChild(C)}else{C=document.createElement("input");for(var E in G){C[E]=G[E]}}return C}};if(typeof fleegix=="undefined"){fleegix={}}fleegix.ejs={};fleegix.ejs.templateTextCache={};fleegix.ejs.Template=function(B){var A;var C=B||{};this.mode=null;this.templateText=C.text||this.getTemplateTextFromNode(C.node);this.afterLoaded=C.afterLoaded;this.source="";this.markup=A;if(typeof this.templateText=="undefined"){this.getTemplateTextFromUrl(C)}};fleegix.ejs.Template.prototype=new function(){var _REGEX=/(<%%)|(%%>)|(<%=)|(<%#)|(<%)|(%>\n)|(%>)|(\n)/;this.modes={EVAL:"eval",OUTPUT:"output",APPEND:"append",COMMENT:"comment",LITERAL:"literal"};this.getTemplateTextFromNode=function(node){if(typeof fleegix.string=="undefined"){throw ("Requires fleegix.string module.")}var ret;if(node){ret=node.value;ret=fleegix.string.unescapeXML(ret);ret=fleegix.string.trim(ret)}return ret};this.getTemplateTextFromUrl=function(params){if(typeof fleegix.xhr=="undefined"){throw ("Requires fleegix.xhr module.")}var _this=this;var url=params.url;var noCache=params.preventCache||false;var text=fleegix.ejs.templateTextCache[url];if(text&&!noCache){this.templateText=text}else{var callback=function(s){_this.templateText=s;fleegix.ejs.templateTextCache[url]=s;if(typeof _this.afterLoaded=="function"){_this.afterLoaded()}};var opts;if(params.async){opts={url:url,method:"GET",preventCache:noCache,async:true,handleSuccess:callback};fleegix.xhr.send(opts)}else{opts={url:url,method:"GET",preventCache:noCache,async:false};text=fleegix.xhr.send(opts);callback(text)}}};this.process=function(p){var params=p||{};this.data=params.data||{};var domNode=params.domNode;this.source=this.source||"";if(!this.source){this.generateSource()}var _output="";with(this.data){eval(this.source)}this.markup=_output;if(domNode){domNode.innerHTML=this.markup}return this.markup};this.generateSource=function(){var line="";var matches=this.parseTemplateText();if(matches){for(var i=0;i<matches.length;i++){line=matches[i];if(line){this.scanLine(line)}}}};this.parseTemplateText=function(){var str=this.templateText;var pat=_REGEX;var result=pat.exec(str);var arr=[];while(result){var firstPos=result.index;var lastPos=pat.lastIndex;if(firstPos!==0){arr.push(str.substring(0,firstPos));str=str.slice(firstPos)}arr.push(result[0]);str=str.slice(result[0].length);result=pat.exec(str)}if(str!==""){arr.push(str)}return arr};this.scanLine=function(line){var _this=this;var _addOutput=function(){line=line.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/"/g,"\\\"");_this.source+="_output += \""+line+"\";"};switch(line){case"<%":this.mode=this.modes.EVAL;break;case"<%=":this.mode=this.modes.OUTPUT;break;case"<%#":this.mode=this.modes.COMMENT;break;case"<%%":this.mode=this.modes.LITERAL;this.source+="_output += \""+line+"\";";break;case"%>":case"%>\n":if(this.mode==this.modes.LITERAL){_addOutput()}this.mode=null;break;default:if(this.mode){switch(this.mode){case this.modes.EVAL:this.source+=line;break;case this.modes.OUTPUT:this.source+="_output += "+line+";";break;case this.modes.COMMENT:break;case this.modes.LITERAL:_addOutput();break}}else{_addOutput()}}}};fleegix.xml=new function(){var A=/^[\s\n\r\t]+|[\s\n\r\t]+$/g;var B=function(E,D){if(E){var C=null;if(E instanceof Array==false){C=[];C.push(E)}else{C=E}C.push(D);return C}else{return D}};this.parse=function(F,E){var I={};var C=[];var G;var J;var K;var D;if(E){C=F.getElementsByTagName(E)}else{C=F.childNodes}for(var H=0;H<C.length;H++){G=C[H];if(G.nodeType==1){J=G.tagName;if(G.firstChild){if(G.childNodes.length==1){K=G.firstChild.nodeType;if(K==3||K==4||K==8){D=G.firstChild.nodeValue.replace(A,"");I[J]=B(I[J],D)}else{if(K==1){I[J]=B(I[J],this.parse(G.firstChild))}}}else{I[J]=B(I[J],this.parse(G))}}else{I[J]=B(I[J],null)}}}return I};this.createDoc=function(F){if(typeof DOMParser!="undefined"){return(new DOMParser()).parseFromString(F,"application/xml")}else{if(typeof ActiveXObject!="undefined"){var E=XML.newDocument();E.loadXML(F);return E}else{var C="data:text/xml;charset=utf-8,"+encodeURIComponent(F);var D=new XMLHttpRequest();D.open("GET",C,false);D.send(null);return D.responseXML}}};this.getXMLDoc=function(G,D){var C=[];var E=null;if(document.all){var F=document.getElementById(G).innerHTML;E=new ActiveXObject("Microsoft.XMLDOM");E.loadXML(F);E=E.documentElement}else{C=window.document.body.getElementsByTagName(D);E=C[0]}return E}};for(var p in fleegix){exports[p]=fleegix[p]}